{% extends "base_logged_in.html" %}
{% load i18n %}
{% load static %}
{% load widget_tweaks %}
{% load crispy_forms_tags %}
{% load template_filters %}

{% block title %}{% trans "Detail dokumentu" %}{% endblock %}
{% block head %}
<link rel="stylesheet" type="text/css" href="{% static 'bs-stepper.min.css' %}"/>
{% endblock %}

{% block content %}
  <div class="app-entity-knihovna_3d">
    {% include "toolbar_dokument.html" with d=dokument  showcontrols=True is_3d=True %}

    {% include "state_component_document.html" with dokument=dokument %}

    <div class="card app-card-form">
      <div class="card-header">
        <div class="app-fx app-left">
          {% trans "Detail" %}
        </div>
        {% if show.editovat %}
        <div class="app-fx app-right">
          <div class="btn-group" role="group">
            <a class="btn" href="{% url 'dokument:edit-model-3D' dokument.ident_cely %}" rel="tooltip"
               data-placement="top" title="{% trans 'Upravit' %}">
              <span class="material-icons">edit</span>
            </a>
          </div>
        </div>
        {% endif %}
      </div>
      <form>
      <div class="card-body">
        {% if warnings %}
        <div class="alert alert-info" role="alert">
          <ul>
            {% for warning in warnings %}
              <li>{{ warning }}</li>
            {% endfor %}
          </ul>
        </div>
      {% endif %}
          {% crispy formDokument %}
        </div>
        {% include "dokument/coor_doc.html" %}
        <div class="card-body">
          {% crispy formExtraData %}
          {% crispy formKomponenta %}
      </div>
      </form>
    </div>

    <div class="card app-card-form">
      <div class="card-header">
        <div class="app-fx app-left">
          {% trans "Bližší specifikace obsahu (předměty a objekty)" %}
        </div>
      </div>
      <div class="card-body">
        <h5>{% trans "Objekty" %}</h5>
        <form class="mb-3" method="POST" action="{% url 'nalez:edit_objekt' komponenta.ident_cely %}"
              onsubmit="editNalezOSubmitButton.disabled = true; return true;">
          {% if formset.objekt.forms %}
          {% crispy formset.objekt formset.helper %}
          {% else %}
          <div class="app-note">
            <span class="material-icons">info</span>
            {% trans "Dokument neobsahuje žádné objekty." %}
          </div>
          {% endif %}
          {% if show.editovat %}
          <button type="submit" id="editNalezOSubmitButton"
                  class="btn btn-primary">{% trans "Upravit objekty" %}</button>
          {% endif %}
        </form>
        <h5>{% trans "Předměty" %}</h5>
        <form method="POST" action="{% url 'nalez:edit_predmet' komponenta.ident_cely %}"
              onsubmit="editNalezPSubmitButton.disabled = true; return true;">
          {% if formset.predmet.forms %}
          {% crispy formset.predmet formset.helper %}
          {% else %}
          <div class="app-note">
            <span class="material-icons">info</span>
            {% trans "Dokument neobsahuje žádné předměty." %}
          </div>
          {% endif %}
          {% if show.editovat %}
          <button type="submit" id="editNalezPSubmitButton"
                  class="btn btn-primary">{% trans "Upravit předměty" %}</button>
          {% endif %}
        </form>
      </div>
    </div>

    <div class="card app-card-form">
      <div class="card-header">
        <div class="app-fx app-left">
          {% trans "Náhledy 3D modelu / Obrázky s texturou" %}
        </div>
        {% if show.editovat %}
        <div class="app-fx app-right">
          <div class="btn-group" role="group">
            <a class="btn app-entity-knihovna_3d" href="{% url 'core:upload_file_dokument' dokument.ident_cely %}"
               rel="tooltip"
               data-placement="top" title="{% trans 'Nahrát soubory' %}">
              <span class="material-icons">publish</span>
            </a>
          </div>
        </div>
        {% endif %}
      </div>
      <div class="card-body">
        {% if soubory %}
          {% include "core/filetable.html" with soubory=soubory show=show.editovat next_url='/dokument/detail/' ident=dokument.ident_cely allow_replace=True %}
        {% else %}
          <div class="app-note">
            <span class="material-icons">info</span>
            {% trans "Dokument zatím neobsahuje žádné soubory." %}
          </div>
        {% endif %}
      </div>
    </div>
  </div>

{% endblock %}

{% block script %}
  <script>
      $(document).ready(function () {
          document.getElementById("id-app-entity-item").innerHTML = "Zapsat nový model 3D"

      })
  </script>
  <script>
    //modal scripts
    document.addEventListener('DOMContentLoaded', function (event) {
      if ("{{show.odeslat_link}}" != "False"){
      var options = Object.assign(defaults, {modalID: "modal-form",
        formURL: "{% url 'dokument:odeslat' dokument.ident_cely %}?sent_stav={{dokument.stav}}",
        formID: "odeslat-dokument-form",
        modalFormID: "#odeslat-dokument-form",
      })
      odeslat_akci_modal = new Modal(options, "dokument-odeslat");
      };
      if ("{{show.vratit_link}}" != "False"){
      var options = Object.assign(defaults, {modalID: "modal-form",
        formURL: "{% url 'dokument:vratit' dokument.ident_cely %}?sent_stav={{dokument.stav}}",
        formID: "vratit-dokument-form",
        modalFormID: "#vratit-dokument-form",
      })
      vratit_akci_modal = new Modal(options, "dokument-vratit");
      }
      if ("{{show.archivovat_link}}" != "False"){
        var options = Object.assign(defaults, {modalID: "modal-form",
          formURL: "{% url 'dokument:archivovat' dokument.ident_cely %}?sent_stav={{dokument.stav}}",
          formID: "archivovat-dokument-form",
          modalFormID: "#archivovat-dokument-form",
        })
      archivovat_akci_modal = new Modal(options, "dokument-archivovat");
      }
      var options = Object.assign(defaults, {modalID: "modal-form",
        formURL: "{% url 'dokument:smazat' dokument.ident_cely %}?sent_stav={{dokument.stav}}",
        formID: "smazat-dokument-form",
        modalFormID: "#smazat-dokument-form",
      })
      smazat_akci_modal = new Modal(options, "dokument-smazat");
  });
  
  </script>


{% endblock %}
