{% load i18n %}
{% load static %}
{% load crispy_forms_tags %}

<form method="POST" id="prihlasit-form">
  <div class="modal-header">
    <h5 class="modal-title">{% trans "projekt.modalForm.Prihlasit.header.title" %}</h5>
    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    {% crispy form %}
  </div>

  <div class="modal-footer">
    <button type="button" class="btn btn-default" data-dismiss="modal">{% translate "projekt.modalForm.Prihlasit.button.close.text" %}</button>
    <button type="submit" class="btn btn-primary">{% translate 'projekt.modalForm.Prihlasit.button.submit.text' %}</button>
  </div>
</form>




{% block script %}
  <script src="{% static 'pamatkova_ochrana_validator.js' %}"></script>
  <script src="{% static '/js/create_message.js' %}"></script>
  <script type="text/javascript" id="js-id-create-osoba">
    //var prihlasit_modal

    var successFunction = function(settings, response) {
      let dropdown = document.getElementById('id_vedouci_projektu');
      let newOption = document.createElement('option');
      newOption.text = response.text;
      newOption.value = response.value;

      dropdown.add(newOption);
      
      $('#id_vedouci_projektu').selectpicker('refresh');
      $('#id_vedouci_projektu').selectpicker('val', response.value);
      dropdown.value = response.value;
      $(settings.modalIDD).modal("hide");
    };
    window.addEventListener("modalLoaded", function() {
      var options = Object.assign(defaults, {
        modalID: "modal-osoba-form",
        formURL: "{% url 'uzivatel:create_osoba' %}",
        formID: "create-osoba-form",
        modalContent: ".modal-content",
        modalForm: ".modal-content osoba-form",
        modalFormID: "#create-osoba-form",
        modalIDD : "#modal-osoba-form",
        successFunc: successFunction,
        firstModalID: "#modal-form",
        secondModal: modal,
      })
      var create_osoba_modal = new Modal(options, "create-osoba")
        //$("#create-osoba").modalForm({
        //    modalID: "#modal-osoba-form",
        //    formURL: "{% url 'uzivatel:create_osoba' %}",
        //    successFunc: successFunction,
        //    
        //});
    
    });
  
    </script>
{% endblock %}
