{% extends "base_logged_in.html" %}
{% load i18n %}
{% load static %}
{% load template_filters %}
{% load template_tags %}

{% block title %}{% trans "projekt.templates.detail.title" %}{% endblock %}
{% block head %}
  <script>
    {% autoescape off %}
      var settings_heatmap_options = {% get_settings "heatmap_options" "projekty_heatmap_options" %};
    {% endautoescape %}
  </script>
  <!-- Leaflet imports -->
  <link rel="stylesheet" href="{% static 'js/Leaflet1.9.4/leaflet.css' %}"/>
        <script src="{% static 'js/Leaflet1.9.4/leaflet.js' %}"></script>
  </script>
    <script src="{% static 'heatmap/heatmap.js' %}"></script>
    <script src="{% static 'heatmap/leaflet-heatmap.js' %}"></script>
    <script src="{% static 'leaflet.markercluster-src.js' %}"></script>
    <link rel="stylesheet" href="{% static 'MarkerCluster.css' %}" />
    <link rel="stylesheet" href="{% static 'MarkerCluster.Default.css' %}" />
  <!--Leaflet FullScreen-->
  <script src='{% static 'js/Leaflet.fullscreen1.0.1/Leaflet.fullscreen.min.js' %}'></script>
  <link href='{% static 'js/Leaflet.fullscreen1.0.1/leaflet.fullscreen.css' %}'rel='stylesheet'/>

  <script>
  var global_csrftoken = '{{ csrf_token }}';
  </script>

  <link rel="stylesheet" href="{% static 'js/Leaflet.EasyButton2.4.0/easy-button.css' %}">
  <script src="{% static 'js/Leaflet.EasyButton2.4.0/easy-button.js' %}"></script>

  <link rel="stylesheet" type="text/css" href="{% static 'bs-stepper.min.css' %}" />
  <!-- static leaflet additional import-->
<link rel="stylesheet" href="{% static 'leaflet.measure.css' %}"/>
<script src="{% static 'leaflet.measure.js' %}"></script>
<script type="text/javascript" src="{% static 'leaflet.coor.js' %}"></script>
<link rel="stylesheet" href="{% static 'leaflet.coor.css' %}"/>
<link rel="stylesheet" href="{% static 'leaflet-search.css' %}"/>
<script src="{% static 'leaflet-search.js' %}"></script>
{% endblock %}

{% block content %}
  <div class="app-entity-projekt">
    {% include "toolbar_projekt.html" with projekt=projekt showcontrols=True %}

    <div class="bs-stepper">
      <div class="bs-stepper-header">
        <div class="step {% if projekt.stav == 0 %}active{% endif %}">
          <button type="button" class="btn step-trigger projekt historie-link pl-0 pr-0"
                  onclick="location.href='{% url 'historie:projekt' projekt.ident_cely %}';">
            <div class="container">
              <div class="row">
                <div class="col-12 pl-0 pr-0 pb-0">
                  <span class="bs-stepper-circle">0</span>
                </div>
              </div>
              <div class="row">
                <div class="col-12 pl-0 pr-0 pb-0">
                <span class="bs-stepper-label">
                    {% trans "projekt.templates.detail.stepper.oznameny.label" %}
                </span>
                </div>
                <div class="col-12 pl-0 pr-0 app-stepper-date-container">
                <span class="app-stepper-date" rel="tooltip" data-placement="bottom"
                      title="{{ history_dates.datum_oznameni.uzivatel }}">
                    {{ history_dates.datum_oznameni.datum|date:'Y-m-d'|default_if_none:"" }}
                </span>
                </div>
              </div>
            </div>
          </button>
        </div>
        <div class="line projekt"></div>
        <div class="step {% if projekt.stav == 1 %}active{% endif %}">
          <button type="button" class="btn step-trigger projekt historie-link pl-0 pr-0"
                  onclick="location.href='{% url 'historie:projekt' projekt.ident_cely %}';">
            <div class="container">
              <div class="row">
                <div class="col-12 pl-0 pr-0 pb-0">
                  <span class="bs-stepper-circle">1</span>
                </div>
              </div>
              <div class="row">
                <div class="col-12 pl-0 pr-0 pb-0">
                <span class="bs-stepper-label">
                    {% trans "projekt.templates.detail.stepper.zapsany.label" %}
                </span>
                </div>
                <div class="col-12 pl-0 pr-0 app-stepper-date-container">
                <span class="app-stepper-date" rel="tooltip" data-placement="bottom"
                      title="{{ history_dates.datum_zapsani.uzivatel }}">
                    {{ history_dates.datum_zapsani.datum|date:'Y-m-d'|default_if_none:"" }}
                </span>
                </div>
              </div>
            </div>
          </button>
        </div>
        <div class="line projekt"></div>
        <div class="step {% if projekt.stav == 2 %}active{% endif %}">
          <button type="button" class="btn step-trigger projekt historie-link pl-0 pr-0"
                  onclick="location.href='{% url 'historie:projekt' projekt.ident_cely %}';">
            <div class="container">
              <div class="row">
                <div class="col-12 pl-0 pr-0 pb-0">
                  <span class="bs-stepper-circle">2</span>
                </div>
              </div>
              <div class="row">
                <div class="col-12 pl-0 pr-0 pb-0">
                <span class="bs-stepper-label">
                    {% trans "projekt.templates.detail.stepper.prihlaseny.label" %}
                </span>
                </div>
                <div class="col-12 pl-0 pr-0 app-stepper-date-container">
                <span class="app-stepper-date" rel="tooltip" data-placement="bottom"
                      title="{{ history_dates.datum_prihlaseni.uzivatel }}">
                    {{ history_dates.datum_prihlaseni.datum|date:'Y-m-d'|default_if_none:"" }}
                </span>
                </div>
              </div>
            </div>
          </button>
        </div>
        <div class="line projekt"></div>
        <div class="step {% if projekt.stav == 3 %}active{% endif %}">
          <button type="button" class="btn step-trigger projekt historie-link pl-0 pr-0"
                  onclick="location.href='{% url 'historie:projekt' projekt.ident_cely %}';">
            <div class="container">
              <div class="row">
                <div class="col-12 pl-0 pr-0 pb-0">
                  <span class="bs-stepper-circle">3</span>
                </div>
              </div>
              <div class="row">
                <div class="col-12 pl-0 pr-0 pb-0">
                <span class="bs-stepper-label">
                    {% trans "projekt.templates.detail.stepper.zahajenvTerenu.label" %}
                </span>
                </div>
                <div class="col-12 pl-0 pr-0 app-stepper-date-container">
                <span class="app-stepper-date" rel="tooltip" data-placement="bottom"
                      title="{{ history_dates.datum_zahajeni_v_terenu.uzivatel }}">
                    {{ history_dates.datum_zahajeni_v_terenu.datum|date:'Y-m-d'|default_if_none:"" }}
                </span>
                </div>
              </div>
            </div>
          </button>
        </div>
        <div class="line projekt"></div>
        <div class="step {% if projekt.stav == 4 %}active{% endif %}">
          <button type="button" class="btn step-trigger projekt historie-link pl-0 pr-0"
                  onclick="location.href='{% url 'historie:projekt' projekt.ident_cely %}';">
            <div class="container">
              <div class="row">
                <div class="col-12 pl-0 pr-0 pb-0">
                  <span class="bs-stepper-circle">4</span>
                </div>
              </div>
              <div class="row">
                <div class="col-12 pl-0 pr-0 pb-0">
                <span class="bs-stepper-label">
                    {% trans "projekt.templates.detail.stepper.ukoncenvTerenu.label" %}
                </span>
                </div>
                <div class="col-12 pl-0 pr-0 app-stepper-date-container">
                <span class="app-stepper-date" rel="tooltip" data-placement="bottom"
                      title="{{ history_dates.datum_ukonceni_v_terenu.uzivatel }}">
                    {{ history_dates.datum_ukonceni_v_terenu.datum|date:'Y-m-d'|default_if_none:"" }}
                </span>
                </div>
              </div>
            </div>
          </button>
        </div>
        <div class="line projekt"></div>
        <div class="step {% if projekt.stav == 5 %}active{% endif %}">
          <button type="button" class="btn step-trigger projekt historie-link pl-0 pr-0"
                  onclick="location.href='{% url 'historie:projekt' projekt.ident_cely %}';">
            <div class="container">
              <div class="row">
                <div class="col-12 pl-0 pr-0 pb-0">
                  <span class="bs-stepper-circle">5</span>
                </div>
              </div>
              <div class="row">
                <div class="col-12 pl-0 pr-0 pb-0">
                <span class="bs-stepper-label">
                    {% trans "projekt.templates.detail.stepper.uzavreny.label" %}
                </span>
                </div>
                <div class="col-12 pl-0 pr-0 app-stepper-date-container">
                <span class="app-stepper-date" rel="tooltip" data-placement="bottom"
                      title="{{ history_dates.datum_uzavreni.uzivatel }}">
                    {{ history_dates.datum_uzavreni.datum|date:'Y-m-d'|default_if_none:"" }}
                </span>
                </div>
              </div>
            </div>
          </button>
        </div>
        <div class="line projekt"></div>
        <div class="step {% if projekt.stav == 6 %}active{% endif %}">
          <button type="button" class="btn step-trigger projekt historie-link pl-0 pr-0"
                  onclick="location.href='{% url 'historie:projekt' projekt.ident_cely %}';">
            <div class="container">
              <div class="row">
                <div class="col-12 pl-0 pr-0 pb-0">
                  <span class="bs-stepper-circle">6</span>
                </div>
              </div>
              <div class="row">
                <div class="col-12 pl-0 pr-0 pb-0">
                <span class="bs-stepper-label">
                    {% trans "projekt.templates.detail.stepper.archivovany.label" %}
                </span>
                </div>
                <div class="col-12 pl-0 pr-0 app-stepper-date-container">
                <span class="app-stepper-date" rel="tooltip" data-placement="bottom"
                      title="{{ history_dates.datum_archivace.uzivatel }}">
                    {{ history_dates.datum_archivace.datum|date:'Y-m-d'|default_if_none:"" }}
                </span>
                </div>
              </div>
            </div>
          </button>
        </div>
        <div class="line projekt"></div>
        <div class="step {% if projekt.stav == 7 %}active{% endif %}">
          <button type="button" class="btn step-trigger projekt historie-link pl-0 pr-0"
                  onclick="location.href='{% url 'historie:projekt' projekt.ident_cely %}';">
            <div class="container">
              <div class="row">
                <div class="col-12 pl-0 pr-0 pb-0">
                  <span class="bs-stepper-circle">7</span>
                </div>
              </div>
              <div class="row">
                <div class="col-12 pl-0 pr-0 pb-0">
                <span class="bs-stepper-label">
                    {% trans "projekt.templates.detail.stepper.navrzenKeZruseni.label" %}
                </span>
                </div>
                <div class="col-12 pl-0 pr-0 app-stepper-date-container">
                <span class="app-stepper-date" rel="tooltip" data-placement="bottom"
                      title="{{ history_dates.datum_navrhu_ke_zruseni.uzivatel }}">
                    {{ history_dates.datum_navrhu_ke_zruseni.datum|date:'Y-m-d'|default_if_none:"" }}
                </span>
                </div>
              </div>
            </div>
          </button>
        </div>
        <div class="line projekt"></div>
        <div class="step {% if projekt.stav == 8 %}active{% endif %}">
          <button type="button" class="btn step-trigger projekt historie-link pl-0 pr-0"
                  onclick="location.href='{% url 'historie:projekt' projekt.ident_cely %}';">
            <div class="container">
              <div class="row">
                <div class="col-12 pl-0 pr-0 pb-0">
                  <span class="bs-stepper-circle">8</span>
                </div>
              </div>
              <div class="row">
                <div class="col-12 pl-0 pr-0 pb-0">
                <span class="bs-stepper-label">
                    {% trans "projekt.templates.detail.stepper.zrusen.label" %}
                </span>
                </div>
                <div class="col-12 pl-0 pr-0 app-stepper-date-container">
                <span class="app-stepper-date" rel="tooltip" data-placement="bottom"
                      title="{{ history_dates.datum_zruseni.uzivatel }}">
                    {{ history_dates.datum_zruseni.datum|date:'Y-m-d'|default_if_none:"" }}
                </span>
                </div>
              </div>
            </div>
          </button>
        </div>
      </div>
    </div>

    <div class="card app-card-form">
      <div class="card-header">
        <div class="app-fx app-left">
          {% trans "projekt.templates.detail.cardheader.detail" %}
        </div>
        {% if show.editovat %}
        <div class="app-fx app-right">
          <div class="btn-group" role="group">
            <a class="btn app-entity-projekt" href="{% url 'projekt:edit' projekt.ident_cely %}" rel="tooltip" data-placement="top" data-offset="0px, 1px" title="{% trans 'projekt.templates.detail.upravit.button.text' %}">
              <span class="material-icons">edit</span>
            </a>
          </div>
        </div>
        {% endif %}
      </div>
      <div class="card-body">
        {% if warnings %}
        <div class="alert alert-info" role="alert">
          <ul>
            {% for warning in warnings %}
              <li>{{ warning }}</li>
            {% endfor %}
          </ul>
        </div>
      {% endif %}
        <div class="row">
          <div class="col-md-6">
            <div class="row">
              <div class="col-md-6 col-lg-3">
                <div class="form-group">
                  <label for="formGroupExampleInput">{% trans "projekt.templates.detail.detailPart.typProjektu.label" %}</label>
                  <input class="form-control" type="text" value="{{ projekt.typ_projektu|check_if_none }}" readonly>
                </div>
              </div>
              <div class="col-md-6 col-lg-3">
                <div class="form-group">
                  <label for="formGroupExampleInput">{% trans "projekt.templates.detail.detailPart.hlavniKatastr.label" %}</label>
                  <input id="main_cadastre_id" class="form-control" type="text" value="{{ projekt.hlavni_katastr|check_if_none }}" readonly>
                </div>
              </div>
              <div class="col-md-12 col-lg-6">
                <div class="form-group">
                  <label>{% trans "projekt.templates.detail.detailPart.dalsiKatastry.label" %}</label>
                  <div class="input-group">
                    <input id="other_cadastre_id" class="form-control app-ellipsis" stype="text" value="{{ dalsi_katastry|katastry_to_list|check_if_none }}" readonly>
                    <div class="input-group-append" data-toggle="popover" data-placement="top"
                    data-content="<strong>{% trans 'projekt.templates.detail.detailPart.seznamKatastru.label' %}:</strong> {{ dalsi_katastry|katastry_to_list|check_if_none }}">
                      <span class="input-group-text">
                        <span class="material-icons">info</span>
                      </span>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-12">
                <div class="form-group">
                  <label for="formGroupExampleInput">{% trans "projekt.templates.detail.detailPart.podnet.label" %}</label>
                  <textarea class="form-control" value="{{ projekt.podnet|check_if_none }}" rows="2" readonly>{{ projekt.podnet|check_if_none }}</textarea>
                </div>
              </div>
              <div class="col-md-12">
                <div class="form-group">
                  <label for="formGroupExampleInput">{% trans "projekt.templates.detail.detailPart.lokalizace.label" %}</label>
                  <input class="form-control" type="text" value="{{ projekt.lokalizace|check_if_none }}" readonly>
                </div>
              </div>
              <div class="col-md-12">
                <div class="form-group">
                  <label for="formGroupExampleInput">{% trans "projekt.templates.detail.detailPart.parcelniCislo.label" %}</label>
                  <input class="form-control" type="text" value="{{ projekt.parcelni_cislo|check_if_none }}" readonly>
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-group">
                  <label for="formGroupExampleInput">{% trans "projekt.templates.detail.detailPart.oznamceniStavby.label" %}</label>
                  <input class="form-control" type="text" value="{{ projekt.oznaceni_stavby|check_if_none }}" readonly>
                </div>
              </div>
              <div class="col-md-6 col-lg-3">
                <div class="form-group">
                  <label for="formGroupExampleInput">{% trans "projekt.templates.detail.detailPart.planovaneZahajeni.label" %}</label>
                  <input class="form-control" type="text" value="{{ projekt.planovane_zahajeni|render_daterange|check_if_none }}" readonly>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div id="projectMap"></div>
            <script >
              var static_url = "{% get_static_prefix %}";
            </script>
            <script>
              var map_translations = {
                CurrentLocationError: '{% trans "mapa.CurrentLocationError" %}',
	              cuzkKatastralniMapa: '{% trans "mapa.cuzkKatastralniMapa" %}',
	              cuzkKatastralniUzemi: '{% trans "mapa.cuzkKatastralniUzemi" %}',
	              cuzkOrtofotomapa: '{% trans "mapa.cuzkOrtofotomapa" %}',
	              cuzkStinovanyeelief5G: '{% trans "mapa.cuzkStinovanyeelief5G" %}',
	              cuzkzakladniMapyCr: '{% trans "mapa.cuzkzakladniMapyCr" %}',
                npuPamatkovaOchrana: '{% trans "mapa.npuPamatkovaOchrana" %}',
	              DefaultTitle: '{% trans "mapa.DefaultTitle" %}',
	              EditTurnOff: '{% trans "mapa.EditTurnOff" %}',
	              EditTurnOn: '{% trans "mapa.EditTurnOn" %}',
	              FullscreenTitle: '{% trans "mapa.FullscreenTitle" %}',
	              FullscreenTitleClose: '{% trans "mapa.FullscreenTitleClose" %}',
	              lokalizaceProjektu: '{% trans "mapa.lokalizaceProjektu" %}',
	              MeasureTitle: '{% trans "mapa.MeasureTitle" %}',
	              openStreetMap: '{% trans "mapa.openStreetMap" %}',
		      openStreetMapSeda: '{% trans "mapa.openStreetMapSeda" %}',
	              projektyP1: '{% trans "mapa.projektyP1" %}',
	              projektyP2: '{% trans "mapa.projektyP2" %}',
	              projektyP3: '{% trans "mapa.projektyP3" %}',
	              projektyP46: '{% trans "mapa.projektyP46" %}',
	              projektyP78: '{% trans "mapa.projektyP78" %}',
	              projektyPAS: '{% trans "mapa.projektyPAS" %}',
	              projektyPIAN: '{% trans "mapa.projektyPIAN" %}',
	              SelectedLocation: '{% trans "mapa.SelectedLocation" %}',
	              zoomInTitle: '{% trans "mapa.zoomInTitle" %}',
	              zoomOutTitle: '{% trans "mapa.zoomOutTitle" %}'
              };
              var leaflet_search_translations = {
                KatastralniUzemi: '{% trans "leaflet_search.KatastralniUzemi" %}',
                Okres: '{% trans "leaflet_search.Okres" %}',
                Obec: '{% trans "leaflet_search.Obec" %}',
                Adresa: '{% trans "leaflet_search.Adresa" %}',
                Ulice: '{% trans "leaflet_search.Ulice" %}',
                Geonames: '{% trans "leaflet_search.Geonames" %}',
                Parcela: '{% trans "leaflet_search.Parcela" %}',
                Stavebni: '{% trans "leaflet_search.Stavebni" %}',
                Pozemkova: '{% trans "leaflet_search.Pozemkova" %}',
                SearchTextCancel: '{% trans "leaflet_search.SearchTextCancel" %}',
                SearchTextError: '{% trans "leaflet_search.SearchTextError" %}'
            };
            </script>
            <script src="{% static 'mapa_pins.js' %}"></script>
            <script src="{% static 'coor_precision.js' %}"></script>
            <script src="{% static 'mapa_basic_grey.js' %}"></script>
            <script src="{% static 'spin/spin.min.js' %}"></script>
            <script src="{% static 'leaflet.spin.min.js' %}"></script>
            <script src="{% static 'leaflet_subgroup.js' %}"></script>
            <script src="{% static 'mapa_projekty.js' %}"></script>
            <script>
                global_map_can_edit=false;
                button_map_lock.disable();
                let coordinates='{{ projekt.geom.coords }}'.slice(1, -1).split(',');
                if(coordinates && coordinates.length>1) {
                    addPointOnLoad(coordinates[1], coordinates[0], '{% trans "mapa.lokalizaceProjektu" %}', "{{projekt.ident_cely}}", "{{projekt.stav}}");
                } else{
                    addProjektWithoutPointOnLoad("{{projekt.ident_cely}}");
                    switchMap(false);
                }
            </script>
          </div>
        </div>
        <div class="row">
          <div class="col-md-12">
            <span class="app-divider-label">{% trans "projekt.templates.detail.detailPart.prihlaseniProjektu.label" %}</span>
            <hr class="mt-0" />
          </div>
          <div class="col-md-4">
            <div class="form-group">
              <label for="formGroupExampleInput">{% trans "projekt.templates.detail.detailPart.vedouciProjektu.label" %}</label>
              <input class="form-control" type="text" value="{{ projekt.vedouci_projektu|check_if_none}}" readonly>
            </div>
          </div>
          <div class="col-md-4">
            <div class="form-group">
              <label for="formGroupExampleInput">{% trans "projekt.templates.detail.detailPart.organizace.label" %}</label>
              <input class="form-control" type="text" value="{{ projekt.organizace|check_if_none}}" readonly>
            </div>
          </div>
          <div class="col-md-4">
            <div class="form-group">
              <label for="formGroupExampleInput">{% trans "projekt.templates.detail.detailPart.uzivatelskeOznaceni.label" %}</label>
              <input class="form-control" type="text" value="{{ projekt.uzivatelske_oznaceni|check_if_none }}" readonly>
            </div>
          </div>
          <div class="col-md-3">
            <div class="form-group">
              <label for="formGroupExampleInput">{% trans "projekt.templates.detail.detailPart.kulturniPamatka.label" %}</label>
              <input class="form-control" type="text" value="{{ projekt.kulturni_pamatka|check_if_none }}" readonly>
            </div>
          </div>
          <div class="col-md-3">
            <div class="form-group">
              <label for="formGroupExampleInput">{% trans "projekt.templates.detail.detailPart.kulturniPamatkaCislo.label" %}</label>
              <input class="form-control" type="text" value="{{ projekt.kulturni_pamatka_cislo|check_if_none }}" readonly>
            </div>
          </div>
          <div class="col-md-6">
            <div class="form-group">
              <label for="formGroupExampleInput">{% trans "projekt.templates.detail.detailPart.kulturniPamatkaPopis.label" %}</label>
              <input class="form-control" type="text" value="{{ projekt.kulturni_pamatka_popis|check_if_none }}" readonly>
            </div>
          </div>
          <div class="col-md-12">
            <span class="app-divider-label">{% trans "projekt.templates.detail.detailPart.terenniCast.divider" %}</span>
            <hr class="mt-0" />
          </div>
          <div class="col-md-3">
            <div class="form-group">
              <label for="formGroupExampleInput">{% trans "projekt.templates.detail.detailPart.datumZahajeni.label" %}</label>
              <input class="form-control" type="text" value="{{ projekt.datum_zahajeni|date:'j.n.Y'|check_if_none }}" readonly>
            </div>
          </div>
          <div class="col-md-1">
            <div class="form-group">
            </div>
          </div>
          <div class="col-md-3">
            <div class="form-group">
              <label for="formGroupExampleInput">{% trans "projekt.templates.detail.detailPart.datumUkonceni.label" %}</label>
              <input class="form-control" type="text" value="{{ projekt.datum_ukonceni|date:'j.n.Y'|check_if_none }}" readonly>
            </div>
          </div>
          <div class="col-md-1">
            <div class="form-group">
            </div>
          </div>
          <div class="col-md-3">
            <div class="form-group">
              <label for="formGroupExampleInput">{% trans "projekt.templates.detail.detailPart.terminOdevzdani.label" %}</label>
              <input class="form-control" type="text" value="{{ projekt.termin_odevzdani_nz|date:'j.n.Y'|check_if_none }}" readonly><!--missings-->
            </div>
          </div>
        </div>
      </div>
    </div>
    {% if show.oznamovatel %}
      <div class="card app-card-form">
        <div class="card-header">
          <div class="app-fx app-left">
            {% trans "projekt.templates.detail.cardHeader.oznamovatel" %}
          </div>
          {% if show.editovat %}
          <div class="app-fx app-right">
            <div class="btn-group" role="group">
              <a class="btn app-entity-projekt" href="{% url 'oznameni_edit' projekt.ident_cely %}" rel="tooltip" data-placement="top" title="{% trans 'projekt.templates.detail.oznamovatel.upravit' %}">
                <span class="material-icons">edit</span>
              </a>
            </div>
          </div>
          {% endif %}
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="formGroupExampleInput">{% trans "projekt.templates.detail.oznamovatelPart.oznamovatel.label" %}</label>
                <input class="form-control" type="text" value="{{ oznamovatel.oznamovatel|check_if_none }}" readonly>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="formGroupExampleInput">{% trans "projekt.templates.detail.oznamovatelPart.odpovednaOsoba.label" %}</label>
                <input class="form-control" type="text" value="{{ oznamovatel.odpovedna_osoba|check_if_none }}" readonly>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="formGroupExampleInput">{% trans "projekt.templates.detail.oznamovatelPart.adresa.label" %}</label>
                <input class="form-control" type="text" value="{{ oznamovatel.adresa|check_if_none }}" readonly>
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group">
                <label for="formGroupExampleInput">{% trans "projekt.templates.detail.oznamovatelPart.telefon.label" %}</label>
                <input class="form-control" type="text" value="{{ oznamovatel.telefon|check_if_none }}" readonly>
              </div>
            </div>
            <div class="col-md-3">
              <div class="form-group">
                <label for="formGroupExampleInput">{% trans "projekt.templates.detail.oznamovatelPart.email.label" %}</label>
                <input class="form-control" type="text" value="{{ oznamovatel.email|check_if_none }}" readonly>
              </div>
            </div>
            <div class="col-md-12">
              <div class="form-group">
                <label for="formGroupExampleInput">{% trans "projekt.templates.detail.oznamovatelPart.poznamka.label" %}</label>
                <input class="form-control" type="text" value="{{ oznamovatel.poznamka|check_if_none }}" readonly>
              </div>
            </div>
          </div>
        </div>
      </div>
    {% endif %}

    <div class="card app-card-form app-table-list-container">
      <div class="card-header">
        <div class="app-fx app-left">
          {% trans "projekt.templates.detail.cardHeader.projektovaDokumetace" %}
        </div>
        {% if show.soubor_nahrat %}
        <div class="app-fx app-right">
          <div class="btn-group" role="group">
            <a class="btn app-entity-projekt" href="{% url 'core:upload_file' 'projekt' projekt.ident_cely %}" rel="tooltip" data-placement="top" title="{% trans 'projekt.templates.detail.dokumentacePart.nahrat' %}">
              <span class="material-icons">publish</span>
            </a>
          </div>
        </div>
        {% endif %}
      </div>
      <div class="card-body content-with-table-responsive">
        {% if soubory %}
          {% include "core/filetable.html" with next_url='/projekt/detail/' ident=projekt.ident_cely allow_replace=False vazba_trida="projekt" %}
        {% else %}
          <div class="app-note">
            <span class="material-icons">info</span>
            {% trans "projekt.templates.detail.dokumentacePart.bezDokumentu" %}
          </div>
        {% endif %}
      </div>
    </div>

    {% if show.akce %}
    <div class="card app-card-form app-card-akce app-table-list-container">
      <div class="card-header">
        <div class="app-fx app-left">
          {% trans "projekt.templates.detail.cardHeader.archeologickeAkce" %}
        </div>
        <div class="app-fx app-right">
          <div class="btn-group" role="group">
            {% if show.pridat_akci == True %}
            <a class="btn app-entity-projekt" href="{% url 'arch_z:zapsat' projekt.ident_cely %}" rel="tooltip" data-placement="top" title="{% trans 'projekt.templates.detail.akcePart.pridat' %}">
              <span class="material-icons">add</span>
            </a>
            {% endif %}
          </div>
        </div>
      </div>
      <div class="card-body content-with-table-responsive">
        {% if akce %}
        <table class="table table-striped table-hover table-sm mb-0">
          <thead>
            <tr>
              <th>{% trans "projekt.templates.detail.akcePart.table.identCely.label" %}</th>
              <th>{% trans "projekt.templates.detail.akcePart.table.hlavniKatastr.label" %}</th>
              <th>{% trans "projekt.templates.detail.akcePart.table.datumZahajeni.label" %}</th>
              <th>{% trans "projekt.templates.detail.akcePart.table.datumUkonceni.label" %}</th>
              <th>{% trans "projekt.templates.detail.akcePart.table.hlavniTyp.label" %}</th>
              <th>{% trans "projekt.templates.detail.akcePart.table.stav.label" %}</th>
            </tr>
          </thead>
          <tbody>
            {% for a in akce %}
              <tr>
                <td class="app-ident-cely">
                  <a href="{% url 'arch_z:detail' a.archeologicky_zaznam.ident_cely %}">
                    <span class="material-icons">brush</span>
                    {{ a.archeologicky_zaznam.ident_cely }}
                  </a>
                </td>
                <td>
                  <strong>{{ a.archeologicky_zaznam.hlavni_katastr }}</strong>
                  {% if a.archeologicky_zaznam.katastry.all %}, {{ a.archeologicky_zaznam.katastry.all|katastry_to_list }}{% endif %}
                </td>
                <td>{{ a.datum_zahajeni|date:'Y-m-d' }}</td>
                <td>{{ a.datum_ukonceni|date:'Y-m-d' }}</td>
                <td>{{ a.hlavni_typ|check_if_none }}</td>
                <td>
                  <div class="container">
                      <span class="badge-span">
                        <span class="badge">{{ a.archeologicky_zaznam.get_stav_display }}</span>
                      </span>
                  </div>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
        {% else %}
          <div class="app-note">
            <span class="material-icons">info</span>
            {% trans "projekt.templates.detail.akcePart.bezAkci" %}
          </div>
        {% endif %}
      </div>
    </div>
    {% endif %}

    {% if show.samostatne_nalezy %}
    <div class="card app-card-form app-card-samostatny_nalez app-table-list-container">
      <div class="card-header">
        <div class="app-fx app-left">
          {% trans "projekt.templates.detail.cardHeader.samostatneNalezy" %}
        </div>
        {% if show.pridat_sam_nalez == True %}
        <div class="app-fx app-right">
          <div class="btn-group" role="group">
            <a class="btn app-entity-projekt" href="{% url 'pas:create-from-project' projekt.ident_cely %}" rel="tooltip" data-placement="top" title="{% trans 'projekt.templates.detail.nalezyPart.vlozit' %}">
              <span class="material-icons">add</span>
            </a>
          </div>
        </div>
        {% endif %}
      </div>
      <div class="card-body content-with-table-responsive">
        {% if samostatne_nalezy %}
        <table class="table table-striped table-hover table-sm mb-0">
          <thead>
            <tr>
              <th>{% trans "projekt.templates.detail.nalezyPart.table.nahled.label" %}</th>
              <th>{% trans "projekt.templates.detail.nalezyPart.table.identCely.label" %}</th>
              <th>{% trans "projekt.templates.detail.nalezyPart.table.stav.label" %}</th>
              <th>{% trans "projekt.templates.detail.nalezyPart.table.katastr.label" %}</th>
              <th>{% trans "projekt.templates.detail.nalezyPart.table.datumNalezu.label" %}</th>
              <th>{% trans "projekt.templates.detail.nalezyPart.table.nalezce.label" %}</th>
              <th>{% trans "projekt.templates.detail.nalezyPart.table.obdobi.label" %}</th>
              <th>{% trans "projekt.templates.detail.nalezyPart.table.druhNalezu.label" %}</th>
            </tr>
          </thead>
          <tbody>
            {% for nalez in samostatne_nalezy %}
              <tr>
                <td>
                  {% if nalez.nahled_soubor and nalez.small_thumbnail %}
                    <img src="{% url 'core:download_thumbnail' 'pas' nalez.ident_cely nalez.nahled_soubor.pk %}" class="image-nahled" data-toggle="modal" data-target="#soubor-modal" data-fullsrc="{% url 'core:download_thumbnail_large' 'pas' nalez.ident_cely nalez.nahled_soubor.pk %}" loading="lazy">
                  {% endif %}
                </td>
                <td class="app-ident-cely">
                  <a href="{% url 'pas:detail' nalez.ident_cely %}">
                    <span class="material-icons">brush</span>
                    {{ nalez.ident_cely }}
                  </a>
                </td>
                <td>
                  <div class="container">
                      <span class="badge-span">
                        <span class="badge">{{ nalez.get_stav_display }}</span>
                      </span>
                  </div>
                </td>
                <td>{{ nalez.katastr }}</td>
                <td>{{ nalez.datum_nalezu|date:'Y/m/d' }}</td>
                <td>{{ nalez.nalezce }}</td>
                <td>{{ nalez.obdobi }}</td>
                <td>{{ nalez.druh_nalezu }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
        {% include "soubor_modal.html" %}
        {% else %}
        <div class="app-note">
          <span class="material-icons">info</span>
          {% trans "projekt.templates.detail.nalezyPart.bezNalezu" %}
        </div>
        {% endif %}
      </div>
    </div>
    {% endif %}

    {% if show.dokumenty %}
    {% include "dokument/dokument_table.html" with type="projekt" zaznam=projekt%}
    {% endif %}

  </div>
  {% include "modals/generovat_potvrzeni.html" with projekt=projekt %}
  {% include "modals/vytvorit_expertni_list.html" with projekt=projekt %}

  <div class="modal osoba-form fade app-modal-form" tabindex="-1" role="dialog" id="modal-osoba-form">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl" role="document">
      <div class="modal-content osoba-form"></div>
    </div>
  </div>

{% endblock %}

{% block script %}
<script src="{% static '/js/create_message.js' %}"></script>
  <script type="text/javascript">
    // projekt stav change scripts
    var modal
    $(document).ready(function() {
      if ("{{show.prihlasit_link}}" != "False"){
      var options = Object.assign(Object.create(defaults), {modalID: "modal-form",
        formURL: "{% url 'projekt:projekt_prihlasit' projekt.ident_cely %}?sent_stav={{projekt.stav}}",
        formID: "prihlasit-form",
        modalFormID: "#prihlasit-form",
      })
      modal = new Modal(options, "projekt-prihlasit");
      }
      else if ("{{show.zahajit_teren_link}}" != "False") {
        var options = Object.assign(Object.create(defaults), {modalID: "modal-form",
        formURL: "{% url 'projekt:projekt_zahajit_v_terenu' projekt.ident_cely %}?sent_stav={{projekt.stav}}",
        formID: "zahajit-v-terenu-form",
        modalFormID: "#zahajit-v-terenu-form",
      })
      modal = new Modal(options, "projekt-zahajit-v-terenu");
      }
      else if ("{{show.ukoncit_teren_link}}" != "False") {
        var options = Object.assign(Object.create(defaults), {modalID: "modal-form",
        formURL: "{% url 'projekt:projekt_ukoncit_v_terenu' projekt.ident_cely %}?sent_stav={{projekt.stav}}",
        formID: "ukoncit-v-terenu-form",
        modalFormID: "#ukoncit-v-terenu-form",
      })
      modal = new Modal(options, "projekt-ukoncit-v-terenu");
      }
      else if ("{{show.uzavrit_link}}" != "False") {
        var options = Object.assign(Object.create(defaults), {modalID: "modal-form",
        formURL: "{% url 'projekt:projekt_uzavrit' projekt.ident_cely %}?sent_stav={{projekt.stav}}",
        formID: "uzavrit-form",
        modalFormID: "#uzavrit-form",
      })
      modal = new Modal(options, "projekt-uzavrit");
      }
      else if ("{{show.archivovat_link}}" != "False") {
        var options = Object.assign(Object.create(defaults), {modalID: "modal-form",
        formURL: "{% url 'projekt:projekt_archivovat' projekt.ident_cely %}?sent_stav={{projekt.stav}}",
        formID: "archivovat-form",
        modalFormID: "#archivovat-form",
      })
      modal = new Modal(options, "projekt-archivovat");
      }
      if ("{{show.vratit_link}}" != "False") {
        var options = Object.assign(Object.create(defaults), {modalID: "modal-form",
        formURL: "{% url 'projekt:projekt_vratit' projekt.ident_cely %}?sent_stav={{projekt.stav}}",
        formID: "vratit-form",
        modalFormID: "#vratit-form",
      })
      var vratit_modal = new Modal(options, "projekt-vratit");
      }//otestovat odtial
      if ("{{show.znovu_zapsat_link}}" != "False") {
        var options = Object.assign(Object.create(defaults), {modalID: "modal-form",
        formURL: "{% url 'projekt:projekt_vratit_navrh_zruseni' projekt.ident_cely %}?sent_stav={{projekt.stav}}",
        formID: "vratit-navrh-form",
        modalFormID: "#vratit-navrh-form",
      })//ok
      var vratit_navrh_zruseni_modal = new Modal(options, "projekt-vratit-navrh-zruseni");
      }
      if ("{{show.navrhnout_zruseni_link}}" != "False") {
        var errorFormFunc = function(settings, response) {
          $('#div_id_reason_text').hide();
          $('#div_id_projekt_id').hide();
          $('<span class="asteriskField">*</span>').insertAfter('#div_id_projekt_id label')
          $('<span class="asteriskField">*</span>').insertAfter('#div_id_reason_text label')
          if ($('input[name=reason]:checked', '#div_id_reason').val() == 'option1') {
            $('#div_id_projekt_id').show();
            };
          if ($('input[name=reason]:checked', '#div_id_reason').val() == 'option6') {
            $('#div_id_reason_text').show();
            };
        };
        var options = Object.assign(Object.create(defaults), {modalID: "modal-form",
        formURL: "{% url 'projekt:projekt_navrhnout_ke_zruseni' projekt.ident_cely %}?sent_stav={{projekt.stav}}",
        formID: "navrh-zruseni-form",
        modalFormID: "#navrh-zruseni-form",
        formErrorFunc: errorFormFunc,
      })
      var navrh_zruseni_modal = new Modal(options, "projekt-navrh-zruseni");
      }//ok
      if ("{{show.zrusit_link}}" != "False") {
        var options = Object.assign(Object.create(defaults), {modalID: "modal-form",
        formURL: "{% url 'projekt:projekt_zrusit' projekt.ident_cely %}?sent_stav={{projekt.stav}}",
        formID: "zrusit-form",
        modalFormID: "#zrusit-form",
      })//ok
      var zrusit_modal = new Modal(options, "projekt-zrusit");
      }
      if ("{{show.schvalit_link}}" != "False") {
        var options = Object.assign(Object.create(defaults), {modalID: "modal-form",
        formURL: "{% url 'projekt:projekt_schvalit' projekt.ident_cely %}?sent_stav={{projekt.stav}}",
        formID: "schvalit-form",
        modalFormID: "#schvalit-form",
      })
      var schvalit_modal = new Modal(options, "projekt-schvalit");
      }
      options = Object.assign(Object.create(defaults), {modalID: "modal-form",
        formURL: "{% url 'projekt:smazat' projekt.ident_cely %}?sent_stav={{projekt.stav}}",
        formID: "smazat-form",
        modalFormID: "#smazat-form",
      })
      var smazat_modal = new Modal(options, "projekt-smazat");
      if ("{{show.pridat_oznamovatele}}" != "False") {
        var options = Object.assign(Object.create(defaults), {modalID: "modal-form",
        formURL: "{% url 'projekt:pridat-oznamovatele' projekt.ident_cely %}?sent_stav={{projekt.stav}}",
        formID: "pridat-oznamovatele-form",
        modalFormID: "#pridat-oznamovatele-form",
      })
      var schvalit_modal = new Modal(options, "projekt-pridat-oznamovatele");
      }
      if ("{{show.upravit_datum_oznameni}}" != "False") {
        var options = Object.assign(Object.create(defaults), {modalID: "modal-form",
        formURL: "{% url 'projekt:upravit-datum-oznameni' projekt.ident_cely %}",
        formID: "upravit-datum-oznameni-form",
        modalFormID: "#upravit-datum-oznameni-form",
      })
      const upravit_datum_oznameni = new Modal(options, "upravit-datum-oznameni");
      }
      if ("{{show.zadost_udaje_oznamovatel}}" != "False") {
        var options = Object.assign(Object.create(defaults), {modalID: "modal-form",
        formURL: "{% url 'projekt:zadost-udaje-oznamovatel' projekt.ident_cely %}",
        formID: "zadost-udaje-oznamovatel-form",
        modalFormID: "#zadost-udaje-oznamovatel-form",
      })
      var zadost_udaje_oznamovatel_modal = new Modal(options, "zadost-udaje-oznamovatel");
      }
      if ("{{show.zadost_odhlaseni_projektu}}" != "False") {
        let options = Object.assign(Object.create(defaults), {modalID: "modal-form",
        formURL: "{% url 'projekt:zadost-odhlaseni-projektu' projekt.ident_cely %}",
        formID: "zadost-odhlaseni-projektu-form",
        modalFormID: "#zadost-odhlaseni-projektu-form",
      })
      let zadost_odhlaseni_projektu_modal = new Modal(options, "zadost-odhlaseni-projektu");
      }
    });
    </script>
{% endblock %}
